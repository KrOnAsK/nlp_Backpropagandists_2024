2024-12-29 21:09:29,907 - __main__ - INFO - Starting BERT training on all variations...
2024-12-29 21:09:31,517 - dl_methods.transformer - INFO - Total unique narratives: 82
2024-12-29 21:09:31,518 - dl_methods.transformer - INFO - Narratives with >= 2 examples: 75
2024-12-29 21:09:31,565 - dl_methods.transformer - INFO - Original dataset size: 1694
2024-12-29 21:09:31,566 - dl_methods.transformer - INFO - Filtered dataset size: 1687
2024-12-29 21:09:31,614 - dl_methods.transformer - INFO - Training set size: 1349, Validation set size: 338
2024-12-29 21:09:31,650 - dl_methods.transformer - INFO - Number of unique labels in mapping: 75
2024-12-29 21:09:31,658 - dl_methods.transformer - INFO - Sample label: 0
2024-12-29 21:09:31,667 - dl_methods.transformer - INFO - Number of unique labels in mapping: 75
2024-12-29 21:09:31,673 - dl_methods.transformer - INFO - Sample label: 72
2024-12-29 21:09:43,528 - dl_methods.transformer - INFO - Number of unique labels: 75
2024-12-29 21:09:44,987 - dl_methods.transformer - INFO - Starting training...
2024-12-29 21:15:12,537 - dl_methods.transformer - INFO - Evaluating model...
2024-12-29 21:15:16,889 - dl_methods.transformer - INFO - Evaluation results: {'eval_loss': 3.236171007156372, 'eval_accuracy': 0.25443786982248523, 'eval_f1': 0.25443786982248523, 'eval_precision': 0.25443786982248523, 'eval_recall': 0.25443786982248523, 'eval_confusion_matrix': {'Class_0': [[220, 93], [11, 14]], 'Class_1': [[335, 0], [3, 0]], 'Class_2': [[336, 0], [2, 0]], 'Class_3': [[305, 20], [4, 9]], 'Class_4': [[331, 0], [7, 0]], 'Class_5': [[337, 0], [1, 0]], 'Class_6': [[334, 0], [4, 0]], 'Class_7': [[334, 0], [4, 0]], 'Class_8': [[327, 0], [11, 0]], 'Class_9': [[331, 0], [7, 0]], 'Class_10': [[330, 0], [8, 0]], 'Class_11': [[337, 0], [1, 0]], 'Class_12': [[336, 0], [2, 0]], 'Class_13': [[337, 0], [1, 0]], 'Class_15': [[336, 0], [2, 0]], 'Class_16': [[337, 0], [1, 0]], 'Class_17': [[337, 0], [1, 0]], 'Class_18': [[335, 0], [3, 0]], 'Class_19': [[337, 0], [1, 0]], 'Class_20': [[336, 0], [2, 0]], 'Class_21': [[333, 0], [5, 0]], 'Class_22': [[332, 0], [6, 0]], 'Class_24': [[337, 0], [1, 0]], 'Class_25': [[321, 4], [11, 2]], 'Class_26': [[330, 0], [8, 0]], 'Class_27': [[337, 0], [1, 0]], 'Class_28': [[335, 0], [3, 0]], 'Class_29': [[333, 0], [5, 0]], 'Class_30': [[335, 0], [3, 0]], 'Class_31': [[332, 0], [6, 0]], 'Class_32': [[336, 0], [2, 0]], 'Class_33': [[335, 0], [3, 0]], 'Class_34': [[295, 27], [12, 4]], 'Class_35': [[336, 0], [2, 0]], 'Class_36': [[331, 0], [7, 0]], 'Class_37': [[337, 0], [1, 0]], 'Class_38': [[334, 0], [4, 0]], 'Class_39': [[336, 0], [2, 0]], 'Class_40': [[337, 0], [1, 0]], 'Class_41': [[334, 0], [4, 0]], 'Class_42': [[337, 0], [1, 0]], 'Class_43': [[337, 0], [1, 0]], 'Class_45': [[337, 0], [1, 0]], 'Class_46': [[336, 0], [2, 0]], 'Class_47': [[337, 0], [1, 0]], 'Class_48': [[337, 0], [1, 0]], 'Class_50': [[337, 0], [1, 0]], 'Class_51': [[336, 0], [2, 0]], 'Class_52': [[335, 0], [3, 0]], 'Class_53': [[334, 0], [4, 0]], 'Class_54': [[335, 0], [3, 0]], 'Class_55': [[165, 108], [8, 57]], 'Class_56': [[337, 0], [1, 0]], 'Class_58': [[337, 0], [1, 0]], 'Class_59': [[337, 0], [1, 0]], 'Class_60': [[337, 0], [1, 0]], 'Class_61': [[334, 0], [4, 0]], 'Class_62': [[326, 0], [12, 0]], 'Class_63': [[329, 0], [9, 0]], 'Class_64': [[332, 0], [6, 0]], 'Class_67': [[337, 0], [1, 0]], 'Class_68': [[335, 0], [3, 0]], 'Class_69': [[335, 0], [3, 0]], 'Class_70': [[332, 0], [6, 0]], 'Class_71': [[337, 0], [1, 0]], 'Class_72': [[332, 0], [6, 0]], 'Class_73': [[335, 0], [3, 0]], 'Class_74': [[335, 0], [3, 0]]}, 'eval_runtime': 4.3478, 'eval_samples_per_second': 77.741, 'eval_steps_per_second': 9.89, 'epoch': 5.0}
2024-12-29 21:15:18,198 - dl_methods.transformer - INFO - Model and tokenizer saved to c:\Users\krona\OneDrive - TU Wien\TU Wien\1. Semester\NLP\nlp_Backpropagandists_2024\code\models/bert_20241229
2024-12-29 21:15:20,904 - __main__ - INFO - BERT training on full data completed. Results: {'eval_loss': 3.236171007156372, 'eval_accuracy': 0.25443786982248523, 'eval_f1': 0.25443786982248523, 'eval_precision': 0.25443786982248523, 'eval_recall': 0.25443786982248523, 'eval_confusion_matrix': {'Class_0': [[220, 93], [11, 14]], 'Class_1': [[335, 0], [3, 0]], 'Class_2': [[336, 0], [2, 0]], 'Class_3': [[305, 20], [4, 9]], 'Class_4': [[331, 0], [7, 0]], 'Class_5': [[337, 0], [1, 0]], 'Class_6': [[334, 0], [4, 0]], 'Class_7': [[334, 0], [4, 0]], 'Class_8': [[327, 0], [11, 0]], 'Class_9': [[331, 0], [7, 0]], 'Class_10': [[330, 0], [8, 0]], 'Class_11': [[337, 0], [1, 0]], 'Class_12': [[336, 0], [2, 0]], 'Class_13': [[337, 0], [1, 0]], 'Class_15': [[336, 0], [2, 0]], 'Class_16': [[337, 0], [1, 0]], 'Class_17': [[337, 0], [1, 0]], 'Class_18': [[335, 0], [3, 0]], 'Class_19': [[337, 0], [1, 0]], 'Class_20': [[336, 0], [2, 0]], 'Class_21': [[333, 0], [5, 0]], 'Class_22': [[332, 0], [6, 0]], 'Class_24': [[337, 0], [1, 0]], 'Class_25': [[321, 4], [11, 2]], 'Class_26': [[330, 0], [8, 0]], 'Class_27': [[337, 0], [1, 0]], 'Class_28': [[335, 0], [3, 0]], 'Class_29': [[333, 0], [5, 0]], 'Class_30': [[335, 0], [3, 0]], 'Class_31': [[332, 0], [6, 0]], 'Class_32': [[336, 0], [2, 0]], 'Class_33': [[335, 0], [3, 0]], 'Class_34': [[295, 27], [12, 4]], 'Class_35': [[336, 0], [2, 0]], 'Class_36': [[331, 0], [7, 0]], 'Class_37': [[337, 0], [1, 0]], 'Class_38': [[334, 0], [4, 0]], 'Class_39': [[336, 0], [2, 0]], 'Class_40': [[337, 0], [1, 0]], 'Class_41': [[334, 0], [4, 0]], 'Class_42': [[337, 0], [1, 0]], 'Class_43': [[337, 0], [1, 0]], 'Class_45': [[337, 0], [1, 0]], 'Class_46': [[336, 0], [2, 0]], 'Class_47': [[337, 0], [1, 0]], 'Class_48': [[337, 0], [1, 0]], 'Class_50': [[337, 0], [1, 0]], 'Class_51': [[336, 0], [2, 0]], 'Class_52': [[335, 0], [3, 0]], 'Class_53': [[334, 0], [4, 0]], 'Class_54': [[335, 0], [3, 0]], 'Class_55': [[165, 108], [8, 57]], 'Class_56': [[337, 0], [1, 0]], 'Class_58': [[337, 0], [1, 0]], 'Class_59': [[337, 0], [1, 0]], 'Class_60': [[337, 0], [1, 0]], 'Class_61': [[334, 0], [4, 0]], 'Class_62': [[326, 0], [12, 0]], 'Class_63': [[329, 0], [9, 0]], 'Class_64': [[332, 0], [6, 0]], 'Class_67': [[337, 0], [1, 0]], 'Class_68': [[335, 0], [3, 0]], 'Class_69': [[335, 0], [3, 0]], 'Class_70': [[332, 0], [6, 0]], 'Class_71': [[337, 0], [1, 0]], 'Class_72': [[332, 0], [6, 0]], 'Class_73': [[335, 0], [3, 0]], 'Class_74': [[335, 0], [3, 0]]}, 'eval_runtime': 4.3478, 'eval_samples_per_second': 77.741, 'eval_steps_per_second': 9.89, 'epoch': 5.0}
2024-12-29 21:15:21,866 - dl_methods.transformer - INFO - Total unique narratives: 46
2024-12-29 21:15:21,867 - dl_methods.transformer - INFO - Narratives with >= 2 examples: 45
2024-12-29 21:15:21,906 - dl_methods.transformer - INFO - Original dataset size: 1175
2024-12-29 21:15:21,906 - dl_methods.transformer - INFO - Filtered dataset size: 1174
2024-12-29 21:15:21,945 - dl_methods.transformer - INFO - Training set size: 939, Validation set size: 235
2024-12-29 21:15:21,975 - dl_methods.transformer - INFO - Number of unique labels in mapping: 45
2024-12-29 21:15:21,982 - dl_methods.transformer - INFO - Sample label: 8
2024-12-29 21:15:21,990 - dl_methods.transformer - INFO - Number of unique labels in mapping: 45
2024-12-29 21:15:21,996 - dl_methods.transformer - INFO - Sample label: 8
2024-12-29 21:15:30,893 - dl_methods.transformer - INFO - Number of unique labels: 45
2024-12-29 21:15:31,664 - dl_methods.transformer - INFO - Starting training...
2024-12-29 21:19:35,678 - dl_methods.transformer - INFO - Evaluating model...
2024-12-29 21:19:38,785 - dl_methods.transformer - INFO - Evaluation results: {'eval_loss': 3.1178362369537354, 'eval_accuracy': 0.2127659574468085, 'eval_f1': 0.2127659574468085, 'eval_precision': 0.2127659574468085, 'eval_recall': 0.2127659574468085, 'eval_confusion_matrix': {'Class_0': [[229, 0], [6, 0]], 'Class_1': [[234, 0], [1, 0]], 'Class_2': [[231, 0], [4, 0]], 'Class_3': [[231, 0], [4, 0]], 'Class_4': [[224, 0], [11, 0]], 'Class_5': [[228, 0], [7, 0]], 'Class_6': [[227, 0], [8, 0]], 'Class_7': [[153, 69], [9, 4]], 'Class_8': [[227, 0], [8, 0]], 'Class_9': [[234, 0], [1, 0]], 'Class_10': [[232, 0], [3, 0]], 'Class_11': [[230, 0], [5, 0]], 'Class_12': [[232, 0], [3, 0]], 'Class_13': [[229, 0], [6, 0]], 'Class_14': [[233, 0], [2, 0]], 'Class_15': [[232, 0], [3, 0]], 'Class_16': [[178, 41], [8, 8]], 'Class_17': [[233, 0], [2, 0]], 'Class_18': [[228, 0], [7, 0]], 'Class_19': [[234, 0], [1, 0]], 'Class_20': [[231, 0], [4, 0]], 'Class_21': [[233, 0], [2, 0]], 'Class_22': [[234, 0], [1, 0]], 'Class_23': [[231, 0], [4, 0]], 'Class_24': [[233, 0], [2, 0]], 'Class_25': [[231, 0], [4, 0]], 'Class_26': [[232, 0], [3, 0]], 'Class_27': [[116, 75], [6, 38]], 'Class_28': [[234, 0], [1, 0]], 'Class_30': [[234, 0], [1, 0]], 'Class_31': [[234, 0], [1, 0]], 'Class_32': [[234, 0], [1, 0]], 'Class_33': [[231, 0], [4, 0]], 'Class_34': [[223, 0], [12, 0]], 'Class_35': [[226, 0], [9, 0]], 'Class_36': [[229, 0], [6, 0]], 'Class_38': [[232, 0], [3, 0]], 'Class_39': [[232, 0], [3, 0]], 'Class_40': [[229, 0], [6, 0]], 'Class_41': [[234, 0], [1, 0]], 'Class_42': [[229, 0], [6, 0]], 'Class_43': [[232, 0], [3, 0]], 'Class_44': [[232, 0], [3, 0]]}, 'eval_runtime': 3.1, 'eval_samples_per_second': 75.805, 'eval_steps_per_second': 9.677, 'epoch': 5.0}
2024-12-29 21:19:39,211 - dl_methods.transformer - INFO - Model and tokenizer saved to c:\Users\krona\OneDrive - TU Wien\TU Wien\1. Semester\NLP\nlp_Backpropagandists_2024\code\models/bert_20241229
2024-12-29 21:19:41,761 - __main__ - INFO - BERT training on UA data completed. Results: {'eval_loss': 3.1178362369537354, 'eval_accuracy': 0.2127659574468085, 'eval_f1': 0.2127659574468085, 'eval_precision': 0.2127659574468085, 'eval_recall': 0.2127659574468085, 'eval_confusion_matrix': {'Class_0': [[229, 0], [6, 0]], 'Class_1': [[234, 0], [1, 0]], 'Class_2': [[231, 0], [4, 0]], 'Class_3': [[231, 0], [4, 0]], 'Class_4': [[224, 0], [11, 0]], 'Class_5': [[228, 0], [7, 0]], 'Class_6': [[227, 0], [8, 0]], 'Class_7': [[153, 69], [9, 4]], 'Class_8': [[227, 0], [8, 0]], 'Class_9': [[234, 0], [1, 0]], 'Class_10': [[232, 0], [3, 0]], 'Class_11': [[230, 0], [5, 0]], 'Class_12': [[232, 0], [3, 0]], 'Class_13': [[229, 0], [6, 0]], 'Class_14': [[233, 0], [2, 0]], 'Class_15': [[232, 0], [3, 0]], 'Class_16': [[178, 41], [8, 8]], 'Class_17': [[233, 0], [2, 0]], 'Class_18': [[228, 0], [7, 0]], 'Class_19': [[234, 0], [1, 0]], 'Class_20': [[231, 0], [4, 0]], 'Class_21': [[233, 0], [2, 0]], 'Class_22': [[234, 0], [1, 0]], 'Class_23': [[231, 0], [4, 0]], 'Class_24': [[233, 0], [2, 0]], 'Class_25': [[231, 0], [4, 0]], 'Class_26': [[232, 0], [3, 0]], 'Class_27': [[116, 75], [6, 38]], 'Class_28': [[234, 0], [1, 0]], 'Class_30': [[234, 0], [1, 0]], 'Class_31': [[234, 0], [1, 0]], 'Class_32': [[234, 0], [1, 0]], 'Class_33': [[231, 0], [4, 0]], 'Class_34': [[223, 0], [12, 0]], 'Class_35': [[226, 0], [9, 0]], 'Class_36': [[229, 0], [6, 0]], 'Class_38': [[232, 0], [3, 0]], 'Class_39': [[232, 0], [3, 0]], 'Class_40': [[229, 0], [6, 0]], 'Class_41': [[234, 0], [1, 0]], 'Class_42': [[229, 0], [6, 0]], 'Class_43': [[232, 0], [3, 0]], 'Class_44': [[232, 0], [3, 0]]}, 'eval_runtime': 3.1, 'eval_samples_per_second': 75.805, 'eval_steps_per_second': 9.677, 'epoch': 5.0}
2024-12-29 21:19:42,690 - dl_methods.transformer - INFO - Total unique narratives: 38
2024-12-29 21:19:42,691 - dl_methods.transformer - INFO - Narratives with >= 2 examples: 32
2024-12-29 21:19:42,708 - dl_methods.transformer - INFO - Original dataset size: 519
2024-12-29 21:19:42,709 - dl_methods.transformer - INFO - Filtered dataset size: 513
2024-12-29 21:19:42,728 - dl_methods.transformer - INFO - Training set size: 410, Validation set size: 103
2024-12-29 21:19:42,740 - dl_methods.transformer - INFO - Number of unique labels in mapping: 32
2024-12-29 21:19:42,741 - dl_methods.transformer - INFO - Sample text: ['morto', 'cheia', 'rpida', 'afeganisto', 'estado', 'emergncia', 'declarar', 'regie', 'onde', 'rio',
2024-12-29 21:19:42,741 - dl_methods.transformer - INFO - Sample label: 3
2024-12-29 21:19:42,744 - dl_methods.transformer - INFO - Number of unique labels in mapping: 32
2024-12-29 21:19:42,745 - dl_methods.transformer - INFO - Sample text: ['desflorestao', 'cerrado', 'impe', 'dever', 'estado', 'rea', 'desmatada', 'cerrado', 'aumentar', 'a
2024-12-29 21:19:42,745 - dl_methods.transformer - INFO - Sample label: 29
2024-12-29 21:19:47,236 - dl_methods.transformer - INFO - Number of unique labels: 32
2024-12-29 21:19:47,943 - dl_methods.transformer - INFO - Starting training...
2024-12-29 21:21:41,420 - dl_methods.transformer - INFO - Evaluating model...
2024-12-29 21:21:42,757 - dl_methods.transformer - INFO - Evaluation results: {'eval_loss': 2.2262892723083496, 'eval_accuracy': 0.4368932038834951, 'eval_f1': 0.4368932038834951, 'eval_precision': 0.4368932038834951, 'eval_recall': 0.4368932038834951, 'eval_confusion_matrix': {'Class_0': [[63, 15], [6, 19]], 'Class_1': [[100, 0], [3, 0]], 'Class_2': [[101, 0], [2, 0]], 'Class_3': [[71, 19], [3, 10]], 'Class_4': [[102, 0], [1, 0]], 'Class_5': [[101, 0], [2, 0]], 'Class_6': [[101, 0], [2, 0]], 'Class_8': [[101, 0], [2, 0]], 'Class_9': [[102, 0], [1, 0]], 'Class_10': [[102, 0], [1, 0]], 'Class_11': [[100, 0], [3, 0]], 'Class_12': [[102, 0], [1, 0]], 'Class_13': [[101, 0], [2, 0]], 'Class_14': [[98, 0], [5, 0]], 'Class_15': [[97, 0], [6, 0]], 'Class_17': [[102, 0], [1, 0]], 'Class_18': [[102, 0], [1, 0]], 'Class_19': [[102, 0], [1, 0]], 'Class_21': [[102, 0], [1, 0]], 'Class_22': [[101, 0], [2, 0]], 'Class_23': [[102, 0], [1, 0]], 'Class_24': [[102, 0], [1, 0]], 'Class_26': [[102, 0], [1, 0]], 'Class_27': [[101, 0], [2, 0]], 'Class_28': [[102, 0], [1, 0]], 'Class_29': [[58, 24], [5, 16]], 'Class_31': [[102, 0], [1, 0]]}, 'eval_runtime': 1.3337, 'eval_samples_per_second': 77.227, 'eval_steps_per_second': 9.747, 'epoch': 5.0}
2024-12-29 21:21:43,788 - dl_methods.transformer - INFO - Model and tokenizer saved to c:\Users\krona\OneDrive - TU Wien\TU Wien\1. Semester\NLP\nlp_Backpropagandists_2024\code\models/bert_20241229
2024-12-29 21:21:45,838 - __main__ - INFO - BERT training on CC data completed. Results: {'eval_loss': 2.2262892723083496, 'eval_accuracy': 0.4368932038834951, 'eval_f1': 0.4368932038834951, 'eval_precision': 0.4368932038834951, 'eval_recall': 0.4368932038834951, 'eval_confusion_matrix': {'Class_0': [[63, 15], [6, 19]], 'Class_1': [[100, 0], [3, 0]], 'Class_2': [[101, 0], [2, 0]], 'Class_3': [[71, 19], [3, 10]], 'Class_4': [[102, 0], [1, 0]], 'Class_5': [[101, 0], [2, 0]], 'Class_6': [[101, 0], [2, 0]], 'Class_8': [[101, 0], [2, 0]], 'Class_9': [[102, 0], [1, 0]], 'Class_10': [[102, 0], [1, 0]], 'Class_11': [[100, 0], [3, 0]], 'Class_12': [[102, 0], [1, 0]], 'Class_13': [[101, 0], [2, 0]], 'Class_14': [[98, 0], [5, 0]], 'Class_15': [[97, 0], [6, 0]], 'Class_17': [[102, 0], [1, 0]], 'Class_18': [[102, 0], [1, 0]], 'Class_19': [[102, 0], [1, 0]], 'Class_21': [[102, 0], [1, 0]], 'Class_22': [[101, 0], [2, 0]], 'Class_23': [[102, 0], [1, 0]], 'Class_24': [[102, 0], [1, 0]], 'Class_26': [[102, 0], [1, 0]], 'Class_27': [[101, 0], [2, 0]], 'Class_28': [[102, 0], [1, 0]], 'Class_29': [[58, 24], [5, 16]], 'Class_31': [[102, 0], [1, 0]]}, 'eval_runtime': 1.3337, 'eval_samples_per_second': 77.227, 'eval_steps_per_second': 9.747, 'epoch': 5.0}
